<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The OAuth 2.0 Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The OAuth 2.0 Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Hammer-Lahav, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">D. Recordon</td></tr>
<tr><td class="header">Expires: October 9, 2010</td><td class="header">Facebook</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Hardt</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 7, 2010</td></tr>
</table></td></tr></table>
<h1><br />The OAuth 2.0 Protocol<br />draft-ietf-oauth-00</h1>

<h3>Abstract</h3>

<p>
	    This specification describes the OAuth 2.0 protocol. OAuth provides a method for making
	    authenticated HTTP requests using a token - an identifier used to denote an access grant
	    with specific scope, duration, and other attributes. Tokens are issued to third-party
	    clients by an authorization server with the approval of the resource owner. OAuth defines
	    multiple flows for obtaining a token to support a wide range of client types and user
	    experience.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on October 9, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Authors<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.4.</a>&nbsp;
Notational Conventions<br />
<a href="#get_token">3.</a>&nbsp;
Obtaining an Access Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Authorization Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Flow Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#client_id">3.3.</a>&nbsp;
Client Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.4.</a>&nbsp;
User Delegation Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#web_callback_flow">3.4.1.</a>&nbsp;
Web Callback Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#native_app_flow">3.4.2.</a>&nbsp;
Native Application Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#user_agent_flow">3.4.3.</a>&nbsp;
User-Agent Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#device_flow">3.4.4.</a>&nbsp;
Device Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">3.5.</a>&nbsp;
End User Credentials Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#username_password_flow">3.5.1.</a>&nbsp;
Username and Password Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">3.6.</a>&nbsp;
Autonomous Client Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#client_credentials_flow">3.6.1.</a>&nbsp;
Client Credentials Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#assertion_flow">3.6.2.</a>&nbsp;
Assertion Flow<br />
<a href="#refresh_token">4.</a>&nbsp;
Refreshing an Access Token<br />
<a href="#access_resource">5.</a>&nbsp;
Accessing a Protected Resource<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#using_ssl">5.1.</a>&nbsp;
Bearer Token Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">5.1.1.</a>&nbsp;
HTTP Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.1.2.</a>&nbsp;
URI Query Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.1.3.</a>&nbsp;
Form-Encoded Body Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#using_signatures">5.2.</a>&nbsp;
Signed Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#compute_sig">5.2.1.</a>&nbsp;
Computing the signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sig_headers">5.2.2.</a>&nbsp;
Client Calls Protected Resource Using HTTP Headers<br />
<a href="#authn_header">6.</a>&nbsp;
The WWW-Authenticate Response Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">6.1.</a>&nbsp;
The 'realm' Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#authz_uri_attribute">6.2.</a>&nbsp;
The 'authorization-uri' Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.3.</a>&nbsp;
The 'timestamp' Attribute<br />
<a href="#authz_header">7.</a>&nbsp;
The Authorization Request Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">7.1.</a>&nbsp;
The 'token' Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">7.2.</a>&nbsp;
The 'nonce' Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">7.3.</a>&nbsp;
The 'timestamp' Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">7.4.</a>&nbsp;
The 'signature' Attribute<br />
<a href="#anchor34">8.</a>&nbsp;
Security Considerations<br />
<a href="#anchor35">9.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor36">10.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor37">Appendix&nbsp;A.</a>&nbsp;
Differences from OAuth 1.0a<br />
<a href="#anchor38">Appendix&nbsp;B.</a>&nbsp;
Document History<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Authors</h3>

<p>
	      This specification was authored with the participation and based on the work of
	      Allen Tom (Yahoo!), Brian Eaton (Google), Brent Goldman (Facebook), Luke Shepard
	      (Facebook), Raffi Krikorian (Twitter), and Yaron Goland (Microsoft).
	    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>
        With the increasing use of distributed web services and cloud computing, third-party
        applications require access to server-hosted resources. These resources are usually
        private and require authentication using the resource owner's credentials (typically a
        username and password). In the traditional client-server authentication model, a client
        accessing a protected resource on a server presents the resource owner's credentials in
        order to authenticate and gain access.
      
</p>
<p>
        Resource owners should not be required to share their credentials when granting third-party
        applications access to their protected resources. They should also have the ability to
        restrict access to a limited subset of the resources they control, to limit access
        duration, or to limit access to the methods supported by these resources.
      
</p>
<p>
        OAuth provides a method for making authenticated HTTP requests using a token - an
        identifier used to denote an access grant with specific scope, duration, and other
        attributes. Tokens are issued to third-party clients by an authorization server with the
        approval of the resource owner. Instead of sharing their credentials with the client,
        resource owners grant access by authenticating directly with the authorization server which
        in turn issues a token to the client. The client uses the token (and optional secret) to
        authenticate with the resource server and gain access.
      
</p>
<p>
        For example, a web user (resource owner) can grant a printing service (client) access to
        her private photos stored at a photo sharing service (resource server), without sharing her
        username and password with the printing service. Instead, she authenticates directly with
        the photo sharing service (authorization server) which issues the printing service
        delegation-specific credentials (token).
      
</p>
<p>
        The use of OAuth with any other transport protocol than <a class='info' href='#RFC2616'>HTTP<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616]
        is undefined.
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Terminology</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>resource server</dt>
<dd>
              
              An <a class='info' href='#RFC2616'>HTTP<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] server capable of accepting authenticated
              resource requests using the OAuth protocol.
            
</dd>
<dt>protected resource</dt>
<dd>
              
              An access-restricted resource which can be obtained from a resource server using
              an OAuth-authenticated request.
            
</dd>
<dt>client</dt>
<dd>
              
              An HTTP client capable of making authenticated requests for protected resources using
              the OAuth protocol.
            
</dd>
<dt>resource owner</dt>
<dd>
              
	            An entity capable of granting access to a protected resource.
            
</dd>
<dt>end user</dt>
<dd>
	            
	            A human resource owner.
	          
</dd>
<dt>access token</dt>
<dd>
              
              A unique identifier used by the client to make authenticated requests on behalf of
              the resource owner. Access tokens may have a matching secret.
            
</dd>
<dt>authorization server</dt>
<dd>
              
              An HTTP server capable of issuing tokens after successfully authenticating the
              resource owner and obtaining authorization. The authorization server may be the same
              server as the resource server, or a separate entity.
            
</dd>
<dt>authorization endpoint</dt>
<dd>
              
              The authorization server's HTTP endpoint authenticating the resource owner, obtaining
              authorization, issuing tokens, and refreshing expired tokens.
            
</dd>
<dt>client identifier</dt>
<dd>
              
              An unique identifier issued by the client to identify itself to the authorization
              server. Client identifiers may have a matching secret.
            
</dd>
<dt>refresh token</dt>
<dd>
              
              A unique identifier used by the client to replace an expired access token with a new
              access token without having to involve the resource owner. A refresh token is used
              when the access token is valid for a shorter time period than the duration of the
              access grant approved by the resource owner.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Overview</h3>

<p>
		      Clients interact with a protected resource, first by requesting access (which is granted
		      in the form of an access token) from the authorization server, and then by authenticating
		      with the resource server by presenting the access token. <a class='info' href='#Figure 1'>Figure&nbsp;1</a>
		      demonstrates the flow between the client and authorization server (A, B), and the flow
		      between the client and resource server (C, D), when the client is acting autonomously
		      (the client is also the resource owner).
	      
</p><br /><hr class="insert" />
<a name="Figure 1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +---+                                  +---------------+
  |   |--(A)------ Credentials ---------&gt;| Authorization |
  | C |                                  |    Server     |
  | l |&lt;-(B)------ Access Token ---------|               |
  | i |      (w/ Optional Refresh Token) +---------------+
  | e |
  | n |            HTTP Request          +---------------+
  | t |--(C)--- with Access Token ------&gt;|    Resource   |
  |   |                                  |     Server    |
  |   |&lt;-(D)------ HTTP Response --------|               |
  +---+                                  +---------------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
		      Access token strings can use any internal structure agreed upon between the authorization
		      server and the resource server, but their structure is opaque to the client. Since the
		      access token provides the client access to the protected resource for the life of the
		      access token, the authorization server should issue access tokens which expire within an
		      appropriate time, usually much shorter than the duration of the access grant.
		    
</p>
<p>
	        When an access token expires, the client can request a new access token from the
	        authorization server by presenting its credentials again (<a class='info' href='#Figure 1'>Figure&nbsp;1</a>), or
	        by using the refresh token (if issued with the access token) as shown in
	        <a class='info' href='#Figure 2'>Figure&nbsp;2</a>. Once an expired access token has been replaced with a new
	        access token (A, B), the client uses the new access token as before (C, D).
	      
</p><br /><hr class="insert" />
<a name="Figure 2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +---+                                  +---------------+
  |   |--(A)------ Refresh Token -------&gt;| Authorization |
  | C |                                  |    Server     |
  | l |&lt;-(B)------ Access Token ---------|               |
  | i |                                  +---------------+
  | e |
  | n |            HTTP Request          +---------------+
  | t |--(C)--- with Access Token ------&gt;|    Resource   |
  |   |                                  |     Server    |
  |   |&lt;-(D)----- HTTP Response ---------|               |
  +---+                                  +---------------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	        This specification defines a number of authorization flows to support different client
	        types and scenarios. These authorization flows can be separated into three groups:
	        user delegation flows where the client is acting on behalf of an end user, end user
	        credentials flows where the client uses the end user's credentials directly to obtain
	        authorization, and autonomous flows where the client is acting for itself (the client is
	        also the resource owner).
	      
</p>
<p>
	        Additional authorization flows may be defined by other specifications to cover different
	        scenarios and client types.
        
</p>
<p>
		      The user delegation authorization flows defined by this specifications are:

		      </p>
<ul class="text">
<li>
              Web Callback Flow - This flow is optimized for cases where the client is part of a
              web server application. When an HTTP server is integrated with the client, the client
              can utilize HTTP server resources (such as send user-agent redirect requests and
              receive incoming callback requests) to enhance its interaction with the end user.
              This flow is described in <a class='info' href='#web_callback_flow'>Section&nbsp;3.4.1<span> (</span><span class='info'>Web Callback Flow</span><span>)</span></a>.
		        
</li>
<li>
		          Native Application Flow - This flow is use by clients running as native code on the
		          end user's computer or device outside a user-agent. This flow is described in
		          <a class='info' href='#native_app_flow'>Section&nbsp;3.4.2<span> (</span><span class='info'>Native Application Flow</span><span>)</span></a>.
	          
</li>
<li>
              User-Agent Flow - This flow is designed for clients running inside a user-agent
              (typically a web browser), and therefore cannot receive callbacks from the
              authorization server. This flow is described in <a class='info' href='#user_agent_flow'>Section&nbsp;3.4.3<span> (</span><span class='info'>User-Agent Flow</span><span>)</span></a>.
		        
</li>
<li>
              Device Flow - This flow is described in <a class='info' href='#device_flow'>Section&nbsp;3.4.4<span> (</span><span class='info'>Device Flow</span><span>)</span></a>.
		        
</li>
</ul><p>
		    
</p>
<p>
	        The end user credentials flow defined by this specification is:
	
	        </p>
<ul class="text">
<li>
              Username and Password Flow - This flow is used in cases where the end user trusts
              the client to handle its credentials but it is still undesirable for the client to
              store the end user's username and password. The client uses its client identifier
              and the end user's username and password to obtain an access token. Since the flow
              requires exposing end user credentials to the client, it should only be used where
              other delegation flows cannot be used and the client can be trusted. This flow is
              described in <a class='info' href='#username_password_flow'>Section&nbsp;3.5.1<span> (</span><span class='info'>Username and Password Flow</span><span>)</span></a>.
		        
</li>
</ul><p>
	      
</p>
<p>
	        The autonomous authorization flows defined by this specifications are:
	
	        </p>
<ul class="text">
<li>
              Client Credentials Flow - The client is provisioned with an account name and
              corresponding secret by the authorization server. The client presents the account
              name and secret to the authorization Server in exchange for an access token. The
              client secret is assumed to be high-entropy since it is not designed to be memorize
              by an end user. This flow is described in <a class='info' href='#client_credentials_flow'>Section&nbsp;3.6.1<span> (</span><span class='info'>Client Credentials Flow</span><span>)</span></a>.
			      
</li>
<li>
		          Assertion Flow - The client presents an assertion such as a 
		          <a class='info' href='#OASIS.saml-core-2.0-os'>SAML<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> [OASIS.saml&#8209;core&#8209;2.0&#8209;os] assertion to the authorization
		          server in exchange for an access token. The methods through which the client obtains
		          the assertions are beyond the scope of this specification. This flow is described in
		          <a class='info' href='#assertion_flow'>Section&nbsp;3.6.2<span> (</span><span class='info'>Assertion Flow</span><span>)</span></a>.
			      
</li>
</ul><p>
		    
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Example</h3>

<p>
          [[ Todo ]]
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Notational Conventions</h3>

<p>
          The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT', 'SHOULD', 'SHOULD
          NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this document are to be interpreted as
          described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<p>
          This document uses the Augmented Backus-Naur Form (ABNF) notation of
          <a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>. Additionally, the realm and auth-param
          rules are included from <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, and the URI-Reference rule from
          <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.
        
</p>
<a name="get_token"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Obtaining an Access Token</h3>

<p>
        The client obtains an access token by using one of the authorization flows supported by the
        authorization server. The authorization flows all use the same authorization endpoint, each
        with a different set of request parameters and values.
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Authorization Endpoint</h3>

<p>
          The client obtains the URI of the authorization endpoint from the server's documentation,
          or by making an unauthorized protected resource request (from the
          <tt>WWW-Authenticate</tt> response header
          <a class='info' href='#authz_uri_attribute'>authorization-uri<span> (</span><span class='info'>The 'authorization-uri' Attribute</span><span>)</span></a> attribute).
        
</p>
<p>
          The authorization endpoint advertised by the server MUST NOT include a query or fragment
          components as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3.
        
</p>
<p>
          Since requests to the authorization endpoint result in the transmission of plain text
          credentials in the HTTP request and response, the authorization server MUST require the
          use of a transport-layer mechanism such as TLS or SSL (or a secure channel with
          equivalent protections) when sending requests to the authorization endpoints.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Flow Parameters</h3>

<p>
          Clients should avoid making assumptions about the size of tokens and other server-generated
          values, which are left undefined by this specification. Servers should document the
          expected size of any value they issue.
        
</p>
<a name="client_id"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Client Credentials</h3>

<p>
		      When requesting access from the authorization server, the client identifies itself using
		      its authorization-server-issued client credentials. The client credentials include a
		      client identifier and an OPTIONAL symmetric shared secret. The means through which the
		      client obtains these credentials are beyond the scope of this specification, but usually
		      involve registration with the authorization server.
		    
</p>
<p>
	        The client identifier is used by the authorization server to establish the identity of
	        the client for the purpose of presenting information to the resource owner prior to
	        granting access, as well as for providing different service levels to different clients.
	        They can also be used to block unauthorized clients from requesting access.
	      
</p>
<p>
		      Due to the nature of some clients, authorization servers SHOULD NOT make assumptions
		      about the confidentiality of client credentials without establishing trust with the
		      client operator. Servers SHOULD NOT issue client secrets to the client incapable or
		      keeping their secrets confidential.
		    
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
User Delegation Flows</h3>

<p>
		      User delegation flows are used to grant client access to protected resources by the
		      end user without sharing the end user credentials (typically a username and password)
		      with the client. Instead, the end user authenticates directly with the authorization
		      server, and grants client access to its protected resources.
		    
</p>
<a name="web_callback_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Web Callback Flow</h3>

<p>
            The web callback flow is a user delegation flow suitable for clients capable of
            interacting with the end user's user-agent (typically a web browser) and capable of
            receiving callback requests from the server (capable of acting as an HTTP server).
          
</p><br /><hr class="insert" />
<a name="Figure 3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +----------+         Client Identifier       +---------------+
  |         -+----(A)-- &amp; Callback URI -------&gt;|               |
  | End User |                                 | Authorization |
  |    at    |&lt;---(B)-- User authenticates ---&gt;|     Server    |
  | Browser  |                                 |               |
  |         -+----(C)-- Verification Code ----&lt;|               |
  +-|----|---+                                 +---------------+
    |    |                                         ^      v
   (A)  (C)                                        |      |
    |    |                                         |      |
    ^    v                                         |      |
  +---------+                                      |      |
  |         |&gt;---(D)-- Client Credentials, --------'      |
  |   Web   |           Verification Code,                |
  |  Client |            &amp; Callback URI                   |
  |         |                                             |
  |         |&lt;---(E)-- Access Token ----------------------'
  +---------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	          The web callback flow illustrated in <a class='info' href='#Figure 3'>Figure&nbsp;3</a> includes the following
	          steps:
	
	          </p>
<blockquote class="text"><dl>
<dt>(A)</dt>
<dd>
			          The web client initiates the flow by redirecting the end user's user-agent to the
			          authorization endpoint with its client identifier and a callback URI to which the
			          server will send the end user back once authorization is received (or denied).
			        
</dd>
<dt>(B)</dt>
<dd>
				        The authorization server authenticates the end user (via the user-agent) and
				        prompts the end user to grant or deny the client's access request.
			        
</dd>
<dt>(C)</dt>
<dd>
				        Assuming the end user granted access, the authorization server redirects the
				        user-agent back to the client to the callback URI provided earlier. The
				        authorization includes a verification code for the client to use to obtain an
				        access token.
			        
</dd>
<dt>(D)</dt>
<dd>
				        The client requests an access token from the authorization server by including its
				        client credentials (identifier and secret), as well as the verification code
				        received in the previous step.
			        
</dd>
<dt>(E)</dt>
<dd>
				        The authorization server validates the client credentials and the verification
				        code and responds back with the access token.
			        
</dd>
</dl></blockquote><p>
	        
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.1"></a><h3>3.4.1.1.&nbsp;
Client Requests Access</h3>

<p>
              In order for the end user to grant the client access, the client sends the end user
              to the authorization server. The client constructs the request URI by adding the
              following URI query parameters to the user authorization endpoint URI:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	                
                  REQUIRED. The parameter value MUST be set to
                  <tt>web_callback_access_request</tt> (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
	                
                  REQUIRED. The client identifier as described in <a class='info' href='#client_id'>Section&nbsp;3.3<span> (</span><span class='info'>Client Credentials</span><span>)</span></a>.
                
</dd>
<dt>callback</dt>
<dd>
	                
                  An absolute URI to which the authorization server will redirect the end user back
                  when the end user authorization step is completed. The authorization server MAY
                  require the client to pre-register their callback URI. The callback URI MUST NOT
                  includes a query or a fragment components as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
                  section 3. REQUIRED unless a callback URI has been established between the client
                  and authorization server via other means.
                
</dd>
<dt>state</dt>
<dd>
	                
                  An OPTIONAL opaque value used by the client to maintain state between the request
                  and callback.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
              The client directs the end user to the constructed URI using an HTTP redirection
              response, or by other means available to it via the end user's user-agent. The
              request MUST use the HTTP <tt>GET</tt> method.
            
</p>
<p>
                For example, the client directs the end user's user-agent to make the
                following HTTPS requests (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorization?type=web_callback_access_request&amp;client_id=
      s6BhdRkqt3&amp;callback=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
       HTTP/1.1
  Host: server.example.com

</pre></div>
<p>
              If the client has previously registered a callback URI with the authorization server,
              the authorization server MUST verify that the callback URI received matches the
              registered URI associated with the client identifier.
            
</p>
<p>
              The way in which the server authenticates the end user (e.g. username and password
              login, OpenID, session cookies) and in which the server obtains the end user's
              authorization, including whether it uses a secure channel such as TLS/SSL, is beyond
              the scope of this specification. However, the server MUST first verify the
              identity of the end user.
            
</p>
<p>
              After receiving (or establishing via other means) an authorization decision from the
              resource owner, the authorization server sends the end user's user-agent to the
              provided client callback URI using an HTTP redirection response, or by other means
              available to it via the end user's user-agent.
            
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.1.1"></a><h3>3.4.1.1.1.&nbsp;
End User Grants Access</h3>

<p>
                If the end user authorizes the access request, the authorization server generates a
                verification code and associates it with the client identifier and callback URI. The
                authorization server constructs the request URI by adding the following parameters to
                the query component of callback URI provided by the client:

                </p>
<blockquote class="text"><dl>
<dt>code</dt>
<dd>
	                  
                    REQUIRED. The verification code generated by the authorization server.
                  
</dd>
<dt>state</dt>
<dd>
	                  
                    REQUIRED if the <tt>state</tt> parameter was present in the
                    client authorization request. Set the the exact value received from the client.
                  
</dd>
</dl></blockquote><p>
              
</p>
<p>
                The verification code SHOULD expire shortly after it is issued and allowed for a
                single use.
              
</p>
<p>
                  For example, the server redirects the end user's user-agent by sending the
                  following HTTP response:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: https://client.example.com/cb?code=i1WsRn1uB1

</pre></div>
<p>
                  In turn, the end user's user-agent makes the following HTTPS
                  <tt>GET</tt> request:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /cb?code=i1WsRn1uB1 HTTP/1.1
  Host: client.example.com

</pre></div>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.1.2"></a><h3>3.4.1.1.2.&nbsp;
End User Denies Access</h3>

<p>
                If the end user denied the access request, the authorization server constructs the
                request URI by adding the following parameters to the query component of callback URI
                provided by the client:

                </p>
<blockquote class="text"><dl>
<dt>error</dt>
<dd>
	              	  
                    REQUIRED. The parameter value MUST be set to
                    <tt>user_denied</tt> (case sensitive).
                  
</dd>
<dt>state</dt>
<dd>
	              	  
                    REQUIRED if the <tt>state</tt> parameter was present in the
                    client authorization request. Set the the exact value received from the client.
                  
</dd>
</dl></blockquote><p>
              
</p>
<p>
                  For example, the authorization server directs the client to make the following HTTP
                  request:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /cb?error=user_denied HTTP/1.1
  Host: client.example.com

</pre></div>
<p>
                The authorization flow concludes unsuccessfully.
              
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.2"></a><h3>3.4.1.2.&nbsp;
Client Requests Access Token</h3>

<p>
              The client obtains an access token from the authorization server by making an HTTP
              <tt>POST</tt> request to the authorization endpoint. The client
              constructs a request URI by adding the following REQUIRED parameters to the request:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	                
                  The parameter value MUST be set to
                  <tt>web_callback_token_request</tt> (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
	                
                  The client identifier as described in <a class='info' href='#client_id'>Section&nbsp;3.3<span> (</span><span class='info'>Client Credentials</span><span>)</span></a>.
                
</dd>
<dt>client_secret</dt>
<dd>
	                
                  The client secret as described in <a class='info' href='#client_id'>Section&nbsp;3.3<span> (</span><span class='info'>Client Credentials</span><span>)</span></a>.
                
</dd>
<dt>code</dt>
<dd>
	                
                  The verification code received from the authorization server.
                
</dd>
<dt>callback</dt>
<dd>
	                
                  The callback URI used in the initial request.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example, the client makes the following HTTPS request (line breaks are for display
                purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /access_token HTTP/1.1
  Host: server.example.com

  type=web_callback_token_request&amp;client_id=s6BhdRkqt3&amp;
  client_secret=gX1fBat3bV&amp;code=i1WsRn1uB1&amp;
  callback=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb

</pre></div>
<p>
              The authorization server MUST verify that the verification code, client identity,
              client secret, and callback URI are all valid and match its stored association. If
              the request is valid, the authorization server issues an access token and delivers it
              to the client in the HTTP response body using the
              <tt>application/x-www-form-urlencoded</tt> content type as defined
              by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status code (OK).
            
</p>
<p>
              The response contains the following parameters:

              </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	                
                  REQUIRED. The access token issued by the authorization server.
                
</dd>
<dt>expires_in</dt>
<dd>
	                
                  OPTIONAL. The duration in seconds of the access token lifetime.
                
</dd>
<dt>refresh_token</dt>
<dd>
	                
                  OPTIONAL. The refresh token used to obtain new access tokens using the same
                  end user access grant as described in <a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=SlAV32hkKG&amp;refresh_token=8xLOxBtZp8&amp;expires_in=3600

</pre></div>
<p>
              The authorization server MUST retain the scope, duration, and other access attributes
              approved by the end user, and enforce these restrictions when receiving a protected
              resource request made with the token issued.
            
</p>
<p>
              If the request is invalid, the authorization server returns an error message in the
              HTTP response body using the
              <tt>application/x-www-form-urlencoded</tt> content type as defined
              by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 400 status code (Bad Request).
            
</p>
<p>
               The response contains the following parameter:

              </p>
<blockquote class="text"><dl>
<dt>error_reason</dt>
<dd>
	                
                  OPTIONAL. The parameter value MUST be set to either
                  <tt>callback_mismatch</tt> or
                  <tt>expired_verification_code</tt> (case sensitive).
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 400 Bad Request

  error_reason=expired_verification_code

</pre></div>
<a name="native_app_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Native Application Flow</h3>

<p>
            The native application flow is a user delegation flow suitable for client applications
            running as native code on the end user's computer or device (i.e. executing outside a
            browser). The client is capable of interacting with the end user's user-agent but is
            incapable of receiving callback requests from the server (incapable of acting as an
            HTTP server).
          
</p>
<p>
            The native application flow is similar to the
            <a class='info' href='#web_callback_flow'>web callback flow<span> (</span><span class='info'>Web Callback Flow</span><span>)</span></a> but instead of using a
            callback to deliver the verification code to the client, the authorization server
            displays the verification code to the end user via its user-agent. If the client is
            able to interact with the user-agent, it retrieves the verification code automatically.
            Otherwise, the end user manually enters the verification code into a client dialog.
          
</p>
<p>
            This flow does not utilize the client secret since the client code resides on the end
            user's computer or device which makes the client secret accessible and exploitable.
            Because the client is incapable of receiving callbacks, the access token is encoded
            into the HTML response which exposes it to the end user and other applications residing
            on the computer or device.
          
</p><br /><hr class="insert" />
<a name="Figure 4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +----------+                                 +---------------+
  |         -+----(A)-- Client Identifier ----&gt;|               |
  | End User |                                 | Authorization |
  |    at    |&lt;---(B)-- User authenticates ---&gt;|     Server    |
  | Browser  |                                 |               |
  |          |&lt;---(C)-- Verification Code ----&lt;|               |
  +-|--------+                                 +---------------+
    |    v                                         ^      v
    |    :                                         |      |
   (A)  (D)                                        |      |
    |    :                                         |      |
    ^    v                                         |      |
  +---------+                                      |      |
  |  Native |&gt;---(E)-- Verification Code ----------'      |
  |   App   |                                             |
  |  Client |&lt;---(F)-- Access Token ----------------------'
  +---------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	          The native application flow illustrated in <a class='info' href='#Figure 4'>Figure&nbsp;4</a> includes the
	          following steps:
	
	          </p>
<blockquote class="text"><dl>
<dt>(A)</dt>
<dd>
			          The native application client initiates the flow by opening a user-agent on the end
			          user's computer or device to the authorization endpoint with its client identifier.
			        
</dd>
<dt>(B)</dt>
<dd>
				        The authorization server authenticates the end user (via the user-agent) and
				        prompts the end user to grant or deny the client's access request.
			        
</dd>
<dt>(C)</dt>
<dd>
				        Assuming the end user granted access, the authorization server display the
				        verification code by returning an HTML document to the user-agent with the
				        verification code included in the documents's title and body.
			        
</dd>
<dt>(D)</dt>
<dd>
				        The client interacts with the user-agent and obtains the verification code from the
				        title of the web page displayed by the user-agent. If the client is unable to
				        interact with the user-agent, the end user manually copies the verification code from
				        the user-agent into an interface provided by the client.
			        
</dd>
<dt>(E)</dt>
<dd>
				        The client requests an access token from the authorization server by sending the
				        verification code received in the previous step.
			        
</dd>
<dt>(F)</dt>
<dd>
				        The authorization server validates the verification code and responds back with the
				        access token.
			        
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2.1"></a><h3>3.4.2.1.&nbsp;
Client Requests Access</h3>

<p>
              In order for the end user to grant the client access, the client sends the end user
              to the authorization server. The client constructs the request URI by adding the
              following URI query parameters to the user authorization endpoint URI:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	                
                  REQUIRED. The parameter value MUST be set to
                  <tt>native_app_access_request</tt> (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
	                
                  REQUIRED. The client identifier as described in <a class='info' href='#client_id'>Section&nbsp;3.3<span> (</span><span class='info'>Client Credentials</span><span>)</span></a>.
                
</dd>
<dt>state</dt>
<dd>
	                
                  An OPTIONAL opaque value used by the client to maintain state between the request
                  and callback.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
              The client launches a user-agent on the end user's computer or device, and directs it
              to the constructed URI. The request MUST use the HTTP
              <tt>GET</tt> method.
            
</p>
<p>
                For example, the client directs the end user's user-agent to make the
                following HTTPS requests (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorization?type=native_app_access_request&amp;client_id=
      s6BhdRkqt3 HTTP/1.1
  Host: server.example.com

</pre></div>
<p>
              The way in which the server authenticates the end user (e.g. username and password
              login, OpenID, session cookies) and in which the server obtains the end user's
              authorization, including whether it uses a secure channel such as TLS/SSL, is beyond
              the scope of this specification. However, the server MUST first verify the
              identity of the end user.
            
</p>
<p>
              After receiving (or establishing via other means) an authorization decision from the
              resource owner, the authorization server responds with an HTML document containing
              machine-readable parameters and human-readable instructions.
            
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2.1.1"></a><h3>3.4.2.1.1.&nbsp;
End User Grants Access</h3>

<p>
                If the end user authorizes the access request, the authorization server generates a
                verification code and associates it with the client identifier. The authorization
                server generates an <a class='info' href='#W3C.REC-html40-19980424'>HTML<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> [W3C.REC&#8209;html40&#8209;19980424] document
                response with the following parameters encoded into the document's title:

                </p>
<blockquote class="text"><dl>
<dt>code</dt>
<dd>
	                  
                    REQUIRED. The verification code generated by the authorization server.
                  
</dd>
<dt>state</dt>
<dd>
	                  
                    REQUIRED if the <tt>state</tt> parameter was present in the
                    client authorization request. Set the the exact value received from the client.
                  
</dd>
</dl></blockquote><p>
              
</p>
<p>
                The parameters are encoded into the document's title by serializing them using the
                <tt>application/x-www-form-urlencoded</tt> content type as
                defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>, and appending the string to
                the content of the HTML <tt>&lt;title&gt;</tt> element enclosed
                in parenthesis <tt>()</tt>.
              
</p>
<p>
                  For example:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;title&gt;Authorization Granted (code=i1WsRn1uB1)&lt;/title&gt;

</pre></div>
<p>
                The verification code SHOULD expire shortly after it is issued and allowed for a
                single use.
              
</p>
<p>
                The document's content MUST include the parameters in a human-readable form and
                SHOULD include instructions to assist the end user in manually entering the values
                into the client applications (in case it is unable to automatically retrieve them).
              
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2.1.2"></a><h3>3.4.2.1.2.&nbsp;
End User Denies Access</h3>

<p>
                If the end user denied the access request, the authorization server generates an
                <a class='info' href='#W3C.REC-html40-19980424'>HTML<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> [W3C.REC&#8209;html40&#8209;19980424] document response with the
                following parameters encoded into the document's title:

                </p>
<blockquote class="text"><dl>
<dt>error</dt>
<dd>
	              	  
                    REQUIRED. The parameter value MUST be set to
                    <tt>user_denied</tt> (case sensitive).
                  
</dd>
<dt>state</dt>
<dd>
	              	  
                    REQUIRED if the <tt>state</tt> parameter was present in the
                    client authorization request. Set the the exact value received from the client.
                  
</dd>
</dl></blockquote><p>
              
</p>
<p>
                The parameters are encoded into the document's title by serializing them using the
                <tt>application/x-www-form-urlencoded</tt> content type as
                defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>, and appending the string to
                the content of the HTML <tt>&lt;title&gt;</tt> element enclosed
                in parenthesis <tt>()</tt>.
              
</p>
<p>
                  For example:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;title&gt;Authorization Denied (error=user_denied)&lt;/title&gt;

</pre></div>
<p>
                The authorization flow concludes unsuccessfully.
              
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2.2"></a><h3>3.4.2.2.&nbsp;
Client Requests Access Token</h3>

<p>
              The client obtains an access token from the authorization server by making an HTTP
              <tt>POST</tt> request to the authorization endpoint. The client
              constructs a request URI by adding the following REQUIRED parameters to the request:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	                
                  The parameter value MUST be set to
                  <tt>native_app_token_request</tt> (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
	                
                  The client identifier as described in <a class='info' href='#client_id'>Section&nbsp;3.3<span> (</span><span class='info'>Client Credentials</span><span>)</span></a>.
                
</dd>
<dt>code</dt>
<dd>
	                
                  The verification code received from the authorization server.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example, the client makes the following HTTPS request:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /access_token HTTP/1.1
  Host: server.example.com

  type=native_app_token_request&amp;client_id=s6BhdRkqt3&amp;code=i1WsRn1uB1

</pre></div>
<p>
              The authorization server MUST verify that the verification code, client identity,
              client secret, and callback URI are all valid and match its stored association. If
              the request is valid, the authorization server issues an access token and delivers it
              to the client in the HTTP response body using the
              <tt>application/x-www-form-urlencoded</tt> content type as defined
              by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status code (OK).
            
</p>
<p>
              The response contains the following parameters:

              </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	                
                  REQUIRED. The access token issued by the authorization server.
                
</dd>
<dt>expires_in</dt>
<dd>
	                
                  OPTIONAL. The duration in seconds of the access token lifetime.
                
</dd>
<dt>refresh_token</dt>
<dd>
	                
                  OPTIONAL. The refresh token used to obtain new access tokens using the same
                  end user access grant as described in <a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=SlAV32hkKG&amp;refresh_token=8xLOxBtZp8&amp;expires_in=3600

</pre></div>
<p>
              The authorization server MUST retain the scope, duration, and other access attributes
              approved by the end user, and enforce these restrictions when receiving a protected
              resource request made with the token issued.
            
</p>
<p>
              If the request is invalid, the authorization server returns an error message in the
              HTTP response body using the
              <tt>application/x-www-form-urlencoded</tt> content type as defined
              by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 400 status code (Bad Request).
            
</p>
<p>
               The response contains the following parameter:

              </p>
<blockquote class="text"><dl>
<dt>error_reason</dt>
<dd>
	                
                  OPTIONAL. The parameter value MUST be set to
                  <tt>expired_verification_code</tt> (case sensitive).
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 400 Bad Request

  error_reason=expired_verification_code

</pre></div>
<a name="user_agent_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3"></a><h3>3.4.3.&nbsp;
User-Agent Flow</h3>

<p>
            The user-agent flow is a user delegation flow suitable for client applications residing
            in a user-agent, typically implemented in a browser using a scripting language such as
            JavaScript. The client is capable of interacting with the end user's user-agent but is
            incapable of receiving callback requests from the server (incapable of acting as an
            HTTP server).
          
</p>
<p>
            Instead of receiving callbacks, the client requests the authorization server to
            redirect the user-agent to another web server or local resource accessible to the
            browser which is capable of extracting the access token from the response and passing
            it to the client.
          
</p>
<p>
            This user-agent flow does not utilize the client secret since the client code
            resides on the end user's computer or device which makes the client secret accessible
            and exploitable. Because the client is incapable of receiving callbacks, the access
            token is encoded into the redirection URI which exposes it to the end user and other
            applications residing on the computer or device.
          
</p><br /><hr class="insert" />
<a name="Figure 5"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         +----------+          Client Identifier     +----------------+
         |          |&gt;---(A)-- &amp; Redirection URI ---&gt;|                |
         |          |                                |                |
  End &lt;--+  -  -  - +----(B)-- User authenticates --&gt;|  Authorization |
  User   |          |                                |     Server     |
         |          |&lt;---(C)-- Redirection URI -----&lt;|                |
         |  Client  |         with Access Token      |                |
         |    in    |            in Fragment         +----------------+
         |  Browser |
         |          |                                +----------------+
         |          |&gt;---(D)-- Redirection URI -----&gt;|                |
         |          |          without Fragment      |   Web Server   |
         |          |                                |   with Client  |
         |    (F)   |&lt;---(E)-- Web Page with -------&lt;|    Resource    |
         |  Access  |             Script             |                |
         |   Token  |                                +----------------+
         +----------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	          The user-agent flow illustrated in <a class='info' href='#Figure 5'>Figure&nbsp;5</a> includes the following
	          steps:

	          </p>
<blockquote class="text"><dl>
<dt>(A)</dt>
<dd>
		            The client sends the user-agent to the authorization server and includes its client
		            identifier and redirection URI in the request.
	            
</dd>
<dt>(B)</dt>
<dd>
				        The authorization server authenticates the end user (via the user-agent) and
				        prompts the end user to grant or deny the client's access request.
			        
</dd>
<dt>(C)</dt>
<dd>
				        Assuming the end user granted access, the authorization server redirects the
				        user-agent to the redirection URI provided earlier. The redirection URI includes
				        the access token in the URI fragment.
              
</dd>
<dt>(D)</dt>
<dd>
                The user-agent follows the redirection instructions by making a request to the web
                server which does not include the fragment. The user-agent retains the fragment
                information locally.
              
</dd>
<dt>(E)</dt>
<dd>
                The web server returns a web page containing a script capable of extracting the
                access token from the URI fragment retained by the user-agent.
              
</dd>
<dt>(F)</dt>
<dd>
                The user-agent executes the script provided by the web server which extracts the
                access token and passes it to the client.
              
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3.1"></a><h3>3.4.3.1.&nbsp;
Client Requests Access</h3>

<p>
              In order for the end user to grant the client access, the client sends the end user
              to the authorization server. The client constructs the request URI by adding the
              following URI query parameters to the user authorization endpoint URI:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
                  
                  REQUIRED. The parameter value MUST be set to
                  <tt>web_client_request</tt> (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
                  
                  REQUIRED. The client identifier as described in <a class='info' href='#client_id'>Section&nbsp;3.3<span> (</span><span class='info'>Client Credentials</span><span>)</span></a>.
                
</dd>
<dt>redirection</dt>
<dd>
                  
                  An absolute URI to which the authorization server will redirect the user-agent to
                  when the end user authorization step is completed. The authorization server SOULD
                  require the client to pre-register their redirection URI. The redirection URI
                  MUST NOT includes a query or a fragment components as defined by
                  <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3. REQUIRED unless a redirection URI has been
                  established between the client and authorization server via other means.
                
</dd>
<dt>state</dt>
<dd>
                  
                  An OPTIONAL opaque value used by the client to maintain state between the request
                  and redirection.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
              The client directs the end user to the constructed URI using an HTTP redirection
              response, or by other means available to it via the end user's user-agent. The
              request MUST use the HTTP <tt>GET</tt> method.
            
</p>
<p>
                For example, the client directs the resource owner's user-agent to make the following
                HTTPS request (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /user_authorization?type=flow_web_client&amp;client_id=s6BhdRkqt3&amp;
      redirection=https%3A%2F%2FEexample%2Ecom%2Frd HTTP/1.1
  Host: server.example.com

</pre></div>
<p>
              If the client has previously registered a redirection URI with the authorization server,
              the authorization server MUST verify that the redirection URI received matches the
              registered URI associated with the client identifier.
            
</p>
<p>
              The way in which the server authenticates the end user (e.g. username and password
              login, OpenID, session cookies) and in which the server obtains the end user's
              authorization, including whether it uses a secure channel such as TLS/SSL, is beyond
              the scope of this specification. However, the server MUST first verify the
              identity of the end user.
            
</p>
<p>
              After receiving (or establishing via other means) an authorization decision from the
              resource owner, the authorization server sends the end user's user-agent to the
              provided client redirection URI using an HTTP redirection response.
            
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3.1.1"></a><h3>3.4.3.1.1.&nbsp;
End User Grants Access</h3>

<p>
                If the end user authorizes the access request, the authorization server issues an
                access token and delivers it to the client by adding the following parameters, using
                the <tt>application/x-www-form-urlencoded</tt> format as defined
                by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>, to the redirection URI fragment:

                </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	                  
                    REQUIRED. The access token.
                  
</dd>
<dt>expires_in</dt>
<dd>
	                  
                    OPTIONAL. The duration in seconds of the access token lifetime.
                  
</dd>
<dt>refresh_token</dt>
<dd>
	                  
                    OPTIONAL. The refresh token.
                  
</dd>
<dt>state</dt>
<dd>
                    
                    REQUIRED if the <tt>state</tt> parameter was present in the
                    client authorization request. Set the the exact value received from the client.
                  
</dd>
</dl></blockquote><p>
              
</p>
<p>
                  For example, the server redirects the end user's user-agent by sending the
                  following HTTP response:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: http://example.com/rd#access_token=FJQbwq9&amp;expires_in=3600

</pre></div>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3.1.2"></a><h3>3.4.3.1.2.&nbsp;
End User Denies Access</h3>

<p>
                If the end user denied the access request, the authorization server responds to the
                client by adding the following parameters, using the
                <tt>application/x-www-form-urlencoded</tt> format as defined by
                <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>, to the redirection URI fragment:

                </p>
<blockquote class="text"><dl>
<dt>error</dt>
<dd>
	            	    
                    REQUIRED. The parameter value MUST be set to
                    <tt>user_denied</tt> (case sensitive).
                  
</dd>
<dt>state</dt>
<dd>
	            	    
                    REQUIRED if the <tt>state</tt> parameter was present in the
                    client authorization request. Set the the exact value received from the client.
                  
</dd>
</dl></blockquote><p>
              
</p>
<p>
                  For example, the authorization server responds with the following:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 302 Found
  Location: http://example.com/rd#error=user_denied

</pre></div>
<p>
                The authorization flow concludes unsuccessfully. To extract the error message, the
                client follows the steps described in <a class='info' href='#user_agent_extract'>Section&nbsp;3.4.3.2<span> (</span><span class='info'>Client Extracts Access Token</span><span>)</span></a>.
              
</p>
<a name="user_agent_extract"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3.2"></a><h3>3.4.3.2.&nbsp;
Client Extracts Access Token</h3>

<p>
              The user-agent follows the authorization server redirection response by making an
              HTTP <tt>GET</tt> request to the URI received in the
              <tt>Location</tt> HTTP response header. The user-agent SHALL NOT
              include the fragment component with the request.
            
</p>
<p>
                For example, the user-agent makes the following HTTP
                <tt>GET</tt> request in response to the redirection directive
                received from the authorization server:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /rd HTTP/1.1
  Host: example.com

</pre></div>
<p>
              The HTTP response to the redirection request returns a web page (typically an HTML
              page with an embedded script) capable of accessing the full redirection URI including
              the fragment retained by the user-agent, and extracting the access token (and other
              parameters) contained in the fragment.
            
</p>
<a name="device_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.4"></a><h3>3.4.4.&nbsp;
Device Flow</h3>

<p>
            The device flow is suitable for clients executing on devices which do not have an easy
            data-entry method (e.g. game consoles or media server), but where the end user has
            separate access to a user-agent on another computer or device (e.g. home computer, a
            laptop, or a smartphone). The client is incapable of receiving callback requests from
            the server (incapable of acting as an HTTP server).
          
</p>
<p>
            Instead of interacting with the end user's user-agent, the client instructs the end
            user to use another computer or device and connect to the authorization server to
            approve the access request. Since the client cannot receive callbacks, it polls the
            authorization server repeatedly until the end user completes the approval process.
          
</p>
<p>
            This device flow does not utilize the client secret since the client code
            resides on a local device which makes the client secret accessible and exploitable.
          
</p><br /><hr class="insert" />
<a name="Figure 6"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  +----------+                                +----------------+
  |          |&gt;---(A)-- Client Identifier ---&gt;|                |
  |          |                                |                |
  |          |&lt;---(B)-- Verification Codes --&lt;|                |
  |          |               &amp; URI            |                |
  |  Device  |                                |                |
  |  Client  |          Client Identifier &amp;   |                |
  |          |&gt;---(E)-- Verification Codes --&gt;|                |
  |          |&gt;---(E)---&gt;                     |                |
  |          |&gt;---(E)---&gt;                     |                |
  |          |                                |  Authorization |
  |          |&lt;---(F)-- Access Token --------&lt;|     Server     |
  +----------+                                |                |
        v                                     |                |
        :                                     |                |
       (C) User Verification Code &amp; URI       |                |
        :                                     |                |
        v                                     |                |
  +----------+                                |                |
  | End User |                                |                |
  |    at    |&lt;---(D)-- User authenticates --&gt;|                |
  |  Browser |                                |                |
  +----------+                                +----------------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	          The device flow illustrated in <a class='info' href='#Figure 6'>Figure&nbsp;6</a> includes the following
	          steps:

	          </p>
<blockquote class="text"><dl>
<dt>(A)</dt>
<dd>
		            The client requests access from the authorization server and includes its client
		            identifier in the request.
	            
</dd>
<dt>(B)</dt>
<dd>
	              The authorization server issues a device verification code, a user verification
	              code, and provides the end user authorization URI.
              
</dd>
<dt>(C)</dt>
<dd>
                The client instructs the end user to use its user-agent (elsewhere) and visit the
                provided authorization URI. The client provides the user with the user verification
                code to enter in order to grant access.
              
</dd>
<dt>(D)</dt>
<dd>
				        The authorization server authenticates the end user (via the user-agent) and
				        prompts the end user to grant the client's access request by entering the user
				        verification code provided by the client.
			        
</dd>
<dt>(E)</dt>
<dd>
			          While the end user authorizes (or denies) the client's request (D), the client
			          repeatedly polls the authorization server to find out if the end user completed the
			          user authorization step. The client includes the device verification code, the user
			          verification code, and its client identifier.
		          
</dd>
<dt>(F)</dt>
<dd>
				        Assuming the end user granted access, the authorization server validates the codes
				        provided by the client and responds back with the access token.
			        
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.4.1"></a><h3>3.4.4.1.&nbsp;
Client Requests Access</h3>

<p>
              The client constructs an HTTP 'GET' request to the access token request
              endpoint and includes the following REQUIRED parameters:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	                
                  The parameter value MUST be set to 'device_access_request' (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
	                
                  The client identifier.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
              Since the request results in the transmission of temporary plain text
              credentials in the HTTP response, the authorization server MUST require the use
              of a transport-layer mechanism such as TLS or SSL (or a secure channel with
              equivalent protections).
            
</p>
<p>
                For example, the client makes the following HTTPS request (line breaks are for
                display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /access_token?client_id=s6BhdRkqt3&amp;type=device_access_request
       HTTP/1.1
  Host: server.example.com

</pre></div>
<p>
              Upon receiving an authorization request by the client, the authorization server
              generates a device verification code and a user verification code. These are
              included in the HTTP response body using the
              'application/x-www-form-urlencoded' content type as defined by
              <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status code (OK). The
              response contains the following parameters:

              </p>
<blockquote class="text"><dl>
<dt>device_code</dt>
<dd>
	                
                  REQUIRED. The device verification code.
                
</dd>
<dt>user_code</dt>
<dd>
	                
                  REQUIRED. The user verification code.
                
</dd>
<dt>verification_uri</dt>
<dd>
	                
                  REQUIRED. The user verification URI on the authorization server.
                
</dd>
<dt>expires_in</dt>
<dd>
	                
                  OPTIONAL. The duration in seconds of the verification code lifetime.
                
</dd>
<dt>verification_rate_limit</dt>
<dd>
	                
                  OPTIONAL. The minimum amount of time in seconds that the client SHOULD wait
                  between polling requests to the device authorization URI.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  device_code=74tq5miHKB&amp;user_code=94248&amp;verification_uri=http%3A%2F%2
  Fwww%2Eexample%2Ecom%2Fdevice&amp;verification_rate_limit=3

</pre></div>
<p>
              The client MUST display the user verification URI and the user verification
              code to the end-user, instruct them to visit the user verification URI in a web
              browser, and to enter the user verification token upon doing so (a user
              authorization request).
            
</p>
<p>
              The way in which the authorization server handles the user authorization
              request, including whether it uses a secure channel such as TLS/SSL is beyond
              the scope of this specification. However, the server MUST first verify the
              identity of the resource owner. After doing so, the server MUST prompt the
              end-user to enter the user verification code.
            
</p>
<p>
              The authorization server MUST verify that the user verification code is valid
              and MAY verify that the client is authorized to use this flow. If the request
              is authorized, the authorization server directs the end-user to go back to the
              client device and follow its instructions.
            
</p>
<p>
              The client MAY have an interface element (such as a button) that the end-user
              interacts with to communicate that they have finished the authorization
              process. The client MAY initiate the following request at an arbitrary but
              reasonable interval in order to create a more responsive user experience though
              MUST NOT exceed the verification rate limit if one is specified. The client
              MUST either poll or have an interface element, or both.
            
</p>
<p>
              The client constructs an HTTP 'GET' request to the access token request
              endpoint and includes the following REQUIRED parameters:

              </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	                
                  The parameter value MUST be set to 'flow_device' (case sensitive).
                
</dd>
<dt>client_id</dt>
<dd>
	                
                  The client identifier.
                
</dd>
<dt>device_verification_code</dt>
<dd>
	                
                  The device verification code.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
              Since the request results in the transmission of plain text credentials in the
              HTTP response, the authorization server MUST require the use of a
              transport-layer mechanism such as TLS or SSL (or a secure channel with
              equivalent protections).
            
</p>
<p>
                For example, the client makes the following HTTPS request (line breaks are for display
                purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /access_token?client_id=s6BhdRkqt3&amp;device_verification_code=J2v
      C42OifV HTTP/1.1
  Host: server.example.com

</pre></div>
<p>
              If the request is authorized, the access token is included in the HTTP response
              body using the 'application/x-www-form-urlencoded' content type as defined by
              <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status code (OK). The
              response contains the following parameters:

              </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	                
                  REQUIRED. The access token.
                
</dd>
<dt>expires_in</dt>
<dd>
	                
                  OPTIONAL. The duration in seconds of the access token lifetime.
                
</dd>
<dt>refresh_token</dt>
<dd>
	                
                  OPTIONAL. The refresh token.
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=FJQbwq9OD8&amp;expires_in=600

</pre></div>
<p>
              The authorization server must retain the scope, duration, and other attributes
              approved by the resource owner, and enforce these restrictions when receiving a
              client request made with the tokens issued.
            
</p>
<p>
              Once the client receives and stores the token credentials, it can proceed to
              access protected resources on behalf of the resource owner by making
              authenticated requests (<a class='info' href='#access_resource'>Section&nbsp;5<span> (</span><span class='info'>Accessing a Protected Resource</span><span>)</span></a>) using the access
              token received. Alternatively, it can refresh the access token and request an
              access secret to use in the signature flow (<a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>).
            
</p>
<p>
              If the authorization server is unable to issue an access token to the client,
              the HTTP response body uses the 'application/x-www-form-urlencoded' content
              type as defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 401 status
              code (Unauthorized). The response contains the following REQUIRED parameter:

              </p>
<blockquote class="text"><dl>
<dt>error_reason</dt>
<dd>
	                
                  Value must be one of 'authorization_declined', 'authorization_pending',
                  'slow_down', or 'verification_code_expired' (case sensitive).
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
                For example:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='example'

  error_reason=authorization_pending

</pre></div>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
End User Credentials Flows</h3>

<p>
		    
</p>
<a name="username_password_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Username and Password Flow</h3>

<p>
            This flow is used when the authorization server generally trusts the client to
            temporarily collect the end-user's username and password and it is impossible
            to use one of the other authorization flows. This flow enables a client to act
            on behalf of the resource owner without having to permanently store their
            username and password. This flow also enables clients who previously used
            username and password to perform a conversion to token based credentials.
          
</p>
<p>
            Prior to making a request using this flow, the client MUST have obtained a
            client identifier and access token request endpoint URI from the authorization
            server. How the client prompts the resource owner for their username and
            password is beyond the scope of this specification. The client must discard the
            resource owner's username and password once an access token has been obtained.
          
</p>
<p>
            Because the end-user's username and password flows through the client, it is
            RECOMMENDED that authorization servers only allow 'trusted' clients to have
            access to this flow; it is RECOMMENDED that, by default, a client does not have
            access to this flow, and it must have its abilities elevated somehow. In the
            case of allowing a client to convert usernames and passwords to tokens, it is
            RECOMMENDED that a client only be given access to this flow for a set time
            duration. The method by which to elevate permissions is out of scope for this
            document.
          
</p>
<p>
            The client constructs an HTTP 'POST' request to the access token request
            endpoint and includes the following REQUIRED parameters:

            </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	              
                The parameter value MUST be set to 'flow_username_password' (case sensitive).
              
</dd>
<dt>client_id</dt>
<dd>
	              
                The client identifier.
              
</dd>
<dt>username</dt>
<dd>
 	              
                The resource owner's username.
              
</dd>
<dt>password</dt>
<dd>
	              
                The resource owner's password.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            Since the request results in the transmission of plain text credentials in both
            the HTTP request and response, the authorization server MUST require the use of
            a transport-layer mechanism such as TLS or SSL (or a secure channel with
            equivalent protections).
          
</p>
<p>
              For example, the client makes the following HTTPS request (line breaks are for display
              purposes only):
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /access_token HTTP/1.1
  Host: server.example.com

  client_id=s6BhdRkqt3&amp;username=daveman692&amp;password=1password&amp;type=flow
  _username_password

</pre></div>
<p>
            The authorization server MUST verify that the resource owner's credentials are
            accurate and MAY verify that the client is authorized to use this flow. If the
            request is authorized, the access token is included in the HTTP response body
            using the 'application/x-www-form-urlencoded' content type as defined by
            <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status code (OK).
          
</p>
<p>
            The response contains the following REQUIRED parameter:

            </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	              
                The access token.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            The authorization server MAY also include the following parameters:

            </p>
<blockquote class="text"><dl>
<dt>expires_in</dt>
<dd>
	              
                The duration in seconds of the access token lifetime.
              
</dd>
<dt>refresh_token</dt>
<dd>
	              
                The refresh token.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=FJQbwq9OD8&amp;refresh_token=gO3CHNqpH8

</pre></div>
<p>
            The authorization server must retain the scope, duration, and other attributes approved
            by the resource owner, and enforce these restrictions when receiving a client request
            made with the tokens issued.
          
</p>
<p>
            Once the client receives and stores the token credentials, it can proceed to access
            protected resources on behalf of the resource owner by making authenticated requests
            (<a class='info' href='#access_resource'>Section&nbsp;5<span> (</span><span class='info'>Accessing a Protected Resource</span><span>)</span></a>) using the access token received. Alternatively, it
            can refresh the access token and request an access secret to use in the signature flow
            (<a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>).
          
</p>
<p>
            If the request fails verification, the authorization server SHOULD respond with the
            appropriate HTTP response status code. The authorization server MAY include further
            details about why the request was rejected in the response body.
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='example'

</pre></div>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Autonomous Client Flows</h3>

<p>
		    
</p>
<a name="client_credentials_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.1"></a><h3>3.6.1.&nbsp;
Client Credentials Flow</h3>

<p>
            This flow is suitable when the client acts autonomously in seeking access and is thus not
            accessing protected resources within the context of a given end-user. For example, when a
            client is accessing non-private data or modifying data about itself. This flow SHOULD NOT
            be used when the client is acting on behalf of an end-user.
          
</p>
<p>
            Prior to making a request using this flow, the client MUST have obtained a client
            identifier, client secret, and access token request endpoint URI from the
            authorization server.
          
</p>
<p>
            The client constructs an HTTP 'POST' request to the access token request endpoint and
            includes the following REQUIRED parameters:

            </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	              
                The parameter value MUST be set to 'flow_client' (case sensitive).
              
</dd>
<dt>client_id</dt>
<dd>
	              
                The client identifier.
              
</dd>
<dt>client_secret</dt>
<dd>
	              
                The client secret.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            Since the request results in the transmission of plain text credentials in both the HTTP
            request and response, the authorization server MUST require the use of a transport-layer
            mechanism such as TLS or SSL (or a secure channel with equivalent protections).
          
</p>
<p>
              For example, the client makes the following HTTPS request:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /access_token HTTP/1.1
  Host: server.example.com

  client_id=s6BhdRkqt3&amp;client_secret=8eSEIpnqmM&amp;type=flow_client

</pre></div>
<p>
            The authorization server MUST verify that the resource owner has authorized the
            provisioning of an access token to the client. If the request is authorized, the access
            token is included in the HTTP response body using the 'application/x-www-form-urlencoded'
            content type as defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status
            code (OK).
          
</p>
<p>
            The response contains the following REQUIRED parameter:

            </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	              
                The access token.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            The authorization server MAY also include the following parameters:

            </p>
<blockquote class="text"><dl>
<dt>expires_in</dt>
<dd>
	              
                The duration in seconds of the access token lifetime.
              
</dd>
<dt>refresh_token</dt>
<dd>
	              
                The refresh token.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=FJQbwq9OD8&amp;refresh_token=gO3CHNqpH8

</pre></div>
<p>
            The authorization server must retain the scope, duration, and other attributes approved
            by the resource owner, and enforce these restrictions when receiving a client request
            made with the tokens issued.
          
</p>
<p>
            Once the client receives and stores the token credentials, it can proceed to access
            protected resources on behalf of the resource owner by making authenticated requests
            (<a class='info' href='#access_resource'>Section&nbsp;5<span> (</span><span class='info'>Accessing a Protected Resource</span><span>)</span></a>) using the access token received. Alternatively, it
            can refresh the access token and request an access secret to use in the signature flow
            (<a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>).
          
</p>
<p>
            If the request fails verification, the authorization server SHOULD respond with the
            appropriate HTTP response status code. The authorization server MAY include further
            details about why the request was rejected in the response body.
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='example'

</pre></div>
<a name="assertion_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.2"></a><h3>3.6.2.&nbsp;
Assertion Flow</h3>

<p>
	          The assertion flow requires the client to obtain a assertion such as a
	          <a class='info' href='#OASIS.saml-core-2.0-os'>SAML<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> [OASIS.saml&#8209;core&#8209;2.0&#8209;os] assertion from an assertion issuer
	          prior to initiating this flow. The process in which the assertion is obtained is defined
	          by the assertion issuer and the authorization server, and is beyond the scope of this
	          specification.
	        
</p>
<p>
	          The client makes an HTTPS request to the authorization endpoint using POST. The request
	          MUST contains the following parameters:

            </p>
<blockquote class="text"><dl>
<dt>assertion_format</dt>
<dd>
	              
	              The format of the assertion as defined by the authorization server.
	            
</dd>
<dt>assertion</dt>
<dd>
	              
	              The assertion.
	            
</dd>
</dl></blockquote><p>
          
</p>
<p>
	          If successful, the authorization server returns an HTTP 200 response code (OK) with the
	          access token in the response body. The response body contains the following parameters:

            </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	              
	              REQUIRED. The Access Token.
	            
</dd>
<dt>expires_in</dt>
<dd>
	              
	              OPTIONAL. The duration in seconds of the access token lifetime.
	            
</dd>
</dl></blockquote><p>
          
</p>
<p>
	          If the assertion is not valid, the authorization server MUST respond with an HTTP 401
	          (Unauthorized) response code. The Client MUST obtain a new valid assertion before
	          retrying the request.
	        
</p>
<p>
	          Authorization servers SHOULD issue access tokens with a limited lifetime and require
	          clients to refresh them by requesting a new access token using the same assertion if it
	          is still valid. Otherwise the client MUST obtain a new valid assertion.
	        
</p>
<a name="refresh_token"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Refreshing an Access Token</h3>

<p>
        Authorization servers MAY issue access tokens that expire and thus require clients to
        refresh them. A client determines that an access token needs refreshing either by using the
        access token's expiration information or upon receiving the HTTP 401 Unauthorized response
        when accessing protected resources per <a class='info' href='#access_resource'>Section&nbsp;5<span> (</span><span class='info'>Accessing a Protected Resource</span><span>)</span></a>. A client will
        also refresh a token if it wishes to obtain a corresponding access token secret for use
        when accessing protected resources via signatures (<a class='info' href='#using_signatures'>Section&nbsp;5.2<span> (</span><span class='info'>Signed Requests</span><span>)</span></a>).
      
</p>
<p>
        Prior to making a request using this flow, the client MUST have obtained a client
        identifier, client secret, and access token request endpoint URI from the
        authorization server.
      
</p>
<p>
        The client constructs an HTTP 'POST' request to the access token request endpoint and
        includes the following REQUIRED parameters:

        </p>
<blockquote class="text"><dl>
<dt>type</dt>
<dd>
	          
            The parameter value MUST be set to 'refresh_token' (case sensitive).
          
</dd>
<dt>client_id</dt>
<dd>
	          
            The client identifier.
          
</dd>
<dt>refresh_token</dt>
<dd>
	          
            The refresh token associated with the access token to be refreshed.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        If the client has access to the client secret, the following parameter SHOULD also be added
        to the request:

        </p>
<blockquote class="text"><dl>
<dt>client_secret</dt>
<dd>
	          
            The client secret.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        If the client wishes to obtain an access token for use when accessing protected resources
        via signatures, the following parameters MUST also be added to the request:

        </p>
<blockquote class="text"><dl>
<dt>want_secret</dt>
<dd>
	          
            The parameter value MUST be set to 'true' (case sensitive).
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        Since the request results in the transmission of plain text credentials in both the HTTP
        request and response, the authorization server MUST require the use of a transport-layer
        mechanism such as TLS or SSL (or a secure channel with equivalent protections).
      
</p>
<p>
          For example, the client makes the following HTTPS request:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  POST /refresh_token HTTP/1.1
  Host: server.example.com

  client_id=s6BhdRkqt3&amp;client_secret=8eSEIpnqmM&amp;refresh_token=n4E9O119d

</pre></div>
<p>
        The authorization server MUST verify that the resource owner has still authorized the
        provisioning of an access token to the client and that the refresh token is valid. If the
        request is authorized, the access token is included in the HTTP response body using the
        'application/x-www-form-urlencoded' content type as defined by
        <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> with a 200 status code (OK).
      
</p>
<p>
        If an access token secret is included in the response, the protected resource MUST NOT
        allow the use of the corresponding access token without its secret
        (<a class='info' href='#using_ssl'>Section&nbsp;5.1<span> (</span><span class='info'>Bearer Token Requests</span><span>)</span></a>).
      
</p>
<p>
        The response contains the following REQUIRED parameters:

        </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	          
            The access token.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        The authorization server MAY also include the following parameters:

        </p>
<blockquote class="text"><dl>
<dt>expires_in</dt>
<dd>
	          
            The duration in seconds of the access token lifetime.
          
</dd>
<dt>access_token_secret</dt>
<dd>
	          
            A corresponding access token secret if the client requested one.
          
</dd>
<dt>signature_methods</dt>
<dd>
	          
            A comma-separated list of signature methods supported by the protected resource,
            ordered by preference. REQUIRED if an access token secret is being returned. Possible
            values include 'HMAC-SHA1' and 'HMAC-SHA256' (case-sensitive) as well as any other
            values defined by extensions to this protocol.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
          For example (line breaks are for display purposes only):
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=8F44J2HGMl

</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  access_token=8F44J2HGMl&amp;access_token_secret=h3B2Tw1CHw&amp;signature_meth
  ods=HMAC-SHA1,HMAC-SHA256

</pre></div>
<p>
        If the request fails verification, the authorization server SHOULD respond with the
        appropriate HTTP response status code. The authorization server MAY include further details
        about why the request was rejected in the response body.
      
</p>
<p>
          For example:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='example'

</pre></div>
<a name="access_resource"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Accessing a Protected Resource</h3>

<p>
        OAuth 2.0 supports the ability for clients to make protected resource requests by using
        TLS/SSL (<a class='info' href='#using_ssl'>Section&nbsp;5.1<span> (</span><span class='info'>Bearer Token Requests</span><span>)</span></a>) and/or by signing their HTTP request with shared
        secrets (<a class='info' href='#using_signatures'>Section&nbsp;5.2<span> (</span><span class='info'>Signed Requests</span><span>)</span></a>). Protected resources MUST support clients
        making authenticated requests via TLS/SSL (<a class='info' href='#using_ssl'>Section&nbsp;5.1<span> (</span><span class='info'>Bearer Token Requests</span><span>)</span></a>). Protected
        resources MAY also choose to also support signatures (<a class='info' href='#using_signatures'>Section&nbsp;5.2<span> (</span><span class='info'>Signed Requests</span><span>)</span></a>),
        and it is RECOMMENDED that clients make signature-based authenticated requests via TLS/SSL.
      
</p>
<p>
        If a client includes more than one access token within the request, the protected resource
        MUST respond with a HTTP 400 'Bad Request' error code.
      
</p>
<a name="using_ssl"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Bearer Token Requests</h3>

<p>
          When using TLS/SSL, clients MUST present an access token to authenticate to a protected
          resource. Use of the HTTP 'Authorization' header field as defined by
          <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> is RECOMMENDED, since HTTP implementations are aware that this
          header has special security properties and may require special treatment in caches and
          logs. Protected resources SHOULD take precautions to ensure that access tokens are not
          inadvertently logged or captured. It is RECOMMENDED that clients verify the authenticity
          of the certificate provided when establishing a TLS/SSL connection to the protected
          resource.
        
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
HTTP Header</h3>

<p>
            The protected resource SHOULD allow clients to make authenticated requests by including
            the access token in the HTTP 'Authorization' header. Prior to making a request, the
            client MUST have obtained a valid access token and the API request endpoint URI.
          
</p>
<p>
            The client constructs a HTTP request to the API request endpoint URI and includes the
            HTTP 'Authorization' header field with the auth-scheme name set to 'OAuth'
            (case-insensitive).
          
</p>
<p>
            Since the request results in the transmission of plain text credentials in the HTTP
            request, the protected resource MUST require the use of a transport-layer mechanism
            such as TLS or SSL (or a secure channel with equivalent protections).
          
</p>
<p>
              For example, the client makes the following HTTPS request:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  GET /user/daveman692.json HTTP/1.1
  Host: api.example.com
  Authorization: OAuth access_token='vF9dft4qmT'

</pre></div>
<p>
              Note that per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> section 1.2 the following request is also
              valid:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  GET /user/daveman692.json HTTP/1.1
  Host: api.example.com
  Authorization:  OAuth  access_token = vF9dft4qmT

</pre></div>
<p>
            If the request fails verification, the protected resource SHOULD respond with the
            appropriate HTTP response status code. The protected resource MAY include further
            details about why the request was rejected in the response body or headers.
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='https://api.example.com/'

</pre></div>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
URI Query Parameter</h3>

<p>
            The protected resource MAY allow clients to make authenticated requests by including
            the access token as a URI query parameter. Prior to making a request, the client MUST
            have obtained a valid access token and the API request endpoint URI. While the
            following examples use the HTTP 'GET' method, there's nothing limiting a client to
            use query parameters with other HTTP methods.
          
</p>
<p>
            The client constructs the request URI by adding the following REQUIRED query parameter
            to the API request endpoint:

            </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
  	           
                The access token.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            Since the request results in the transmission of plain text credentials in the HTTP
            request, the protected resource MUST require the use of a transport-layer mechanism
            such as TLS or SSL (or a secure channel with equivalent protections).
          
</p>
<p>
              For example, the client makes the following HTTPS request:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  GET /user/daveman692.json?access_token=vF9dft4qmT HTTP/1.1
  Host: api.example.com

</pre></div>
<p>
            If the request fails verification, the protected resource SHOULD respond with the
            appropriate HTTP response status code. The protected resource MAY include further
            details about why the request was rejected in the response body.
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='https://api.example.com/'

</pre></div>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Form-Encoded Body Parameter</h3>

<p>
            The protected resource MAY allow clients to make authenticated requests by including
            the access token as a parameter in the body of a HTTP request. Prior to making a
            request, the client MUST have obtained a valid access token and the API request
            endpoint URI.
          
</p>
<p>
            The client constructs an HTTP 'POST', 'PUT', or 'DELETE' request to the API request
            endpoint and includes the following REQUIRED parameter:

            </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
	              
                The access token.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            Since the request results in the transmission of plain text credentials in the HTTP
            request, the protected resource MUST require the use of a transport-layer mechanism
            such as TLS or SSL (or a secure channel with equivalent protections).
          
</p>
<p>
              For example, the client makes the following HTTPS request:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  POST /blog/entry HTTP/1.1
  Host: api.example.com

  access_token=vF9dft4qmT

</pre></div>
<p>
            If the request fails verification, the protected resource SHOULD respond with the
            appropriate HTTP response status code. The protected resource MAY include further
            details about why the request was rejected in the response body.
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='https://api.example.com/'

</pre></div>
<a name="using_signatures"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Signed Requests</h3>

<p>
          When using signatures, clients MAY use TLS/SSL as the transport to authenticate to a
          protected resource.
        
</p>
<p>
          The following parameters are obtained (or computed) by clients in order to make protected
          resource requests:

          </p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>
              
              The access token obtained through a refresh token call with the 'want_secret'
              parameter included (<a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>).
            
</dd>
<dt>signature_method</dt>
<dd>
              
              The signature method used by the client to sign the request. The method MUST be one
              of those listed in the 'signature_methods' parameter returned with the access
              token secret (<a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>).
            
</dd>
<dt>timestamp</dt>
<dd>
              
              Unless otherwise specified by the server's documentation, the timestamp is expressed in
              the number of seconds since January 1, 1970 00:00:00 GMT. It MUST be a positive integer.
            
</dd>
<dt>nonce</dt>
<dd>
              
              A nonce is a random string, uniquely generated by the client to allow the server to
              verify that a request has never been made before and helps prevent replay attacks when
              requests are made over a non-secure channel. The nonce value MUST be unique across all
              requests with the same timestamp and token combinations.
            
</dd>
<dt>signature</dt>
<dd>
              
              The computed signature value ensuring the integrity of this request
              (<a class='info' href='#compute_sig'>Section&nbsp;5.2.1<span> (</span><span class='info'>Computing the signature</span><span>)</span></a>).
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          The protocol parameters are added to the request using the
          <a class='info' href='#sig_headers'>HTTP Header<span> (</span><span class='info'>Client Calls Protected Resource Using HTTP Headers</span><span>)</span></a>.
        
</p>
<p>
          Construction of the signature base string follows the process detailed in section 3.4.1
          of <a class='info' href='#I-D.hammer-oauth'>[I&#8209;D.hammer&#8209;oauth]<span> (</span><span class='info'>Hammer-Lahav, E., &ldquo;The OAuth 1.0 Protocol,&rdquo; February&nbsp;2010.</span><span>)</span></a>.
        
</p>
<p>
            For example the request:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  GET /user/daveman692.json?b5=%3D%25%3D&amp;a3=a&amp;c%40=&amp;a2=r%20b HTTP/1.1
  Host: api.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: OAuth
                 access_token='vF9dft4qmT',
                 signature_method='HMAC-SHA1',
                 timestamp='1268998408',
                 nonce='7d8f3e4a',

  c2&amp;a3=2+q

</pre></div>
<p>
            Is represented by the following signature base string (line breaks are for display
            purposes only):
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  GET&amp;amp;http%3A%2F%2Fapi.example.com%2Fuser%2Fdaveman692.json&amp;amp;a2%
  3Dr%2520b%26a3%3D2%252Bq%26a3%3Da%26b5%3D%253D%2525%253D%26c%2540%3D%
  26c2%3D%26nonce%3D7d8f3e4a%26signature_method%3DHMAC-SHA1%26timestamp
  %3D1268998408%26access_token%3DvF9dft4qmT%26version%3D2.0

</pre></div>
<a name="compute_sig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Computing the signature</h3>

<p>
            The authorization server declares which signature methods it accepts via the
            'signature_methods' returned as part of obtaining an access token secret
            (<a class='info' href='#refresh_token'>Section&nbsp;4<span> (</span><span class='info'>Refreshing an Access Token</span><span>)</span></a>). The client declares which signature method is used
            for this request via the 'signature_method' parameter. It then generates a
            signature, and includes it in the 'signature' parameter. The server verifies the
            signature as specified for each method.
          
</p>
<p>
            There is no mandate for a particular signature method as each implementation can have
            its own unique requirements. Authorization servers are free to implement and document
            their own custom methods.
          
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1.1"></a><h3>5.2.1.1.&nbsp;
HMAC-SHA1</h3>

<p>
              The 'HMAC-SHA1' signature method uses the HMAC-SHA1 signature algorithm as defined in
              <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>:

              </p>
<blockquote class="text">
<p>
                  digest = HMAC-SHA1 (key, text)
                
</p>
</blockquote><p>
            
</p>
<p>
              The HMAC-SHA1 function variables are used in following way:

              </p>
<blockquote class="text"><dl>
<dt>text</dt>
<dd>
                  is set to the value of the signature base string.
                
</dd>
<dt>key</dt>
<dd>
                  is set to the access token secret.
                
</dd>
<dt>digest</dt>
<dd>
                  is used to set the value of the 'signature' protocol parameter, after the
                  result octet string is base64-encoded per section 6.8 of <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>.
                
</dd>
</dl></blockquote><p>
            
</p>
<a name="sig_headers"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Client Calls Protected Resource Using HTTP Headers</h3>

<p>
            The protected resource MAY allow clients to make authenticated requests by including
            the access token in the HTTP 'Authorization' header. Prior to making a request, the
            client MUST have obtained a valid access token, a valid access token secret, and the
            API request endpoint URI. It MUST have also constructed the signature base string and
            <a class='info' href='#compute_sig'>computed the signature<span> (</span><span class='info'>Computing the signature</span><span>)</span></a>.
          
</p>
<p>
            The client constructs a HTTP request to the API request endpoint URI and includes the
            HTTP 'Authorization' header field with the auth-scheme name set to 'OAuth'
            (case-insensitive). The protocol parameters and the signature computed in
            <a class='info' href='#compute_sig'>Section&nbsp;5.2.1<span> (</span><span class='info'>Computing the signature</span><span>)</span></a> are included in the Authorization header.
          
</p>
<p>
              For example, a valid request follows the form of:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  GET /user/daveman692.json?b5=%3D%25%3D&amp;a3=a&amp;c%40=&amp;a2=r%20b HTTP/1.1
  Host: api.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: OAuth
                 access_token='vF9dft4qmT',
                 signature_method='HMAC-SHA1',
                 timestamp='1268998408',
                 nonce='7d8f3e4a',
                 signature='hfVFpKvoKp5S6YaNIJ6ljuNYR6s%3D'

  c2&amp;a3=2+q

</pre></div>
<p>
            If the request fails verification, the protected resource SHOULD respond with the
            appropriate HTTP response status code. The protected resource MAY include further
            details about why the request was rejected in the response body or headers.
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  HTTP/1.1 401 Authorization Required
  WWW-Authenticate: OAuth realm='Exmaple'

</pre></div>
<a name="authn_header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
The WWW-Authenticate Response Header</h3>

<p>
        A server receiving a request for a protected resource without a valid
        <a class='info' href='#authz_header'>Authorization header field<span> (</span><span class='info'>The Authorization Request Header</span><span>)</span></a> MUST respond with a 401
        status code (Unauthorized), and includes at least one
        <tt>WWW-Authenticate</tt> header field including a token scheme
        challenge.
      
</p>
<p>
        The <tt>WWW-Authenticate</tt> header field uses the framework defined by
        <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> as follows:
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 challenge       = "Token" RWS token-challenge

 token-challenge = realm
                   [ CS authz-uri ]
                   [ CS timestamp ]

 authz-uri       = "authorization-uri" "=" URI-Reference
 timestamp       = "timestamp" "=" &lt;"&gt; 1*DIGIT &lt;"&gt;

 CS              = OWF "," OWF

</pre></div>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
The 'realm' Attribute</h3>

<p>
        
</p>
<a name="authz_uri_attribute"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
The 'authorization-uri' Attribute</h3>

<p>
        
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
The 'timestamp' Attribute</h3>

<p>
          Signature-based and hash-based authentication methods use timestamps in combination with
          unique nonce values to protect against replay attacks when used over an insecure channel.
        
</p>
<p>
          The timestamp attribute is used by the server to publish its current time, enabling
          clients to synchronize their close with the server. The timestamp value is the current
          time expressed in the number of seconds since January 1, 1970 00:00:00 GMT, and MUST be a
          positive integer.
        
</p>
<p>
          To avoid the need to retain an infinite number of nonce values for future checks, servers
          MAY choose to restrict the time period after which a request with an old timestamp is
          rejected. Servers applying such a restriction SHOULD provide their current time to the
          client either in every challenge or when a request fails due to a timestamp outside the
          allowed window.
        
</p>
<a name="authz_header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
The Authorization Request Header</h3>

<p>
        A client making a request for a protected resource either directly, or in retrying a
        request after receiving a 401 status code (Unauthorized) with a token challenge, MUST
        include at least one <tt>Authorization</tt> header field including
        token scheme credentials.
      
</p>
<p>
        The <tt>Authorization</tt> header field uses the framework defined by
        <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> as follows:
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 credentials    = "Token" RWS token-response

 token-response = token-id
                  [ CS nonce ]
                  [ CS timestamp ]
                  [ CS auth ]

 token-id         = "token" "=" &lt;"&gt; token &lt;"&gt;
 nonce            = "nonce" "=" &lt;"&gt; token &lt;"&gt;
 auth             = "signature" "=" &lt;"&gt; token &lt;"&gt;

</pre></div>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
The 'token' Attribute</h3>

<p>
          The value used to identify the set of token credentials used by the client to
          authenticate. The token identifier can be an opaque string or use a well-defined internal
          structure.
        
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
The 'nonce' Attribute</h3>

<p>
          A random string, uniquely generated by the client to allow the server to verify that a
          request has never been made before and helps prevent replay attacks when requests are
          made over a non-secure channel. The nonce value MUST be unique across all requests with
          the same timestamp and token combinations.
        
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
The 'timestamp' Attribute</h3>

<p>
          The timestamp value is the current time expressed in the number of seconds since
          January 1, 1970 00:00:00 GMT, and MUST be a positive integer.
        
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
The 'signature' Attribute</h3>

<p>
          The output of the authentication method function after applying it to the selected
          coverage.
        
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>
        [[ Todo ]]
      
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>
        [[ Not Yet ]]
      
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>
        [[ Add OAuth 1.0a authors + WG contributors ]]
      
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Differences from OAuth 1.0a</h3>

<p>
      
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Document History</h3>

<p>
        [[ to be removed by RFC editor before publication as an RFC ]]
      
</p>
<p>
        -00

        </p>
<ul class="text">
<li>
            Initial draft based on a combination of WRAP and OAuth 1.0a.
          
</li>
</ul><p>
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</a></td>
<td class="author-text">Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p1-messaging-09.txt">HTTP/1.1, part 1: URIs, Connections, and Message Parsing</a>,&rdquo; draft-ietf-httpbis-p1-messaging-09 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p1-messaging-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2045">[RFC2045]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2045.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2617">[RFC2617]</a></td>
<td class="author-text"><a href="mailto:john@math.nwu.edu">Franks, J.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:jeff@AbiSource.com">Hostetler, J.</a>, <a href="mailto:lawrence@agranat.com">Lawrence, S.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, Luotonen, A., and <a href="mailto:stewart@OpenMarket.com">L. Stewart</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>,&rdquo; RFC&nbsp;2617, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2617.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2617.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2617.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-html40-19980424">[W3C.REC-html40-19980424]</a></td>
<td class="author-text">Hors, A., Jacobs, I., and D. Raggett, &ldquo;<a href="http://www.w3.org/TR/1998/REC-html40-19980424">HTML 4.0 Specification</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-html40-19980424, April&nbsp;1998 (<a href="http://www.w3.org/TR/1998/REC-html40-19980424">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.hammer-oauth">[I-D.hammer-oauth]</a></td>
<td class="author-text">Hammer-Lahav, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-hammer-oauth-10.txt">The OAuth 1.0 Protocol</a>,&rdquo; draft-hammer-oauth-10 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-hammer-oauth-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.hardt-oauth">[I-D.hardt-oauth]</a></td>
<td class="author-text">Hardt, D., Tom, A., Eaton, B., and Y. Goland, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-hardt-oauth-01.txt">OAuth Web Resource Authorization Profiles</a>,&rdquo; draft-hardt-oauth-01 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-hardt-oauth-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:John.Kemp@nokia.com">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf">Assertions and Protocol for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-core-2.0-os, March&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eran Hammer-Lahav (editor)</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eran@hueniverse.com">eran@hueniverse.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David Recordon</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Facebook</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:davidrecordon@facebook.com">davidrecordon@facebook.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.davidrecordon.com/">http://www.davidrecordon.com/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dick Hardt</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dick.hardt@gmail.com">dick.hardt@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://dickhardt.org/">http://dickhardt.org/</a></td></tr>
</table>
</body></html>

